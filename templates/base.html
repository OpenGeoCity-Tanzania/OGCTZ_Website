<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="color-scheme" content="light dark">
        {# Title: prefer page_title variable, fallback to block title #}
        <title>{% if page_title %}{{ page_title }}{% else %}{% block title %}{% endblock %}{% endif %} | {{ site_name }}</title>

        {# Basic SEO meta tags (page can override `page_description` and `page_keywords`) #}
        <meta name="description" content="{{ page_description or default_description }}">
        <meta name="keywords" content="{{ page_keywords or default_keywords }}">
        <link rel="canonical" href="{{ (page_canonical or site_url ~ request.path) }}">

        {# OpenGraph / Social #}
        <meta property="og:site_name" content="{{ site_name }}">
        <meta property="og:title" content="{{ page_title or site_name }}">
        <meta property="og:description" content="{{ page_description or default_description }}">
        <meta property="og:type" content="website">
        <meta property="og:url" content="{{ site_url ~ request.path }}">
        <meta property="og:image" content="{{ site_url }}{{ url_for('static', filename='img/favicons/fav_org/favicon-32x32.png') }}">

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="{{ twitter_handle }}">
        <meta name="twitter:title" content="{{ page_title or site_name }}">
        <meta name="twitter:description" content="{{ page_description or default_description }}">

        {# JSON-LD Organization structured data #}
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "{{ site_name }}",
            "url": "{{ site_url }}",
            "logo": "{{ site_url }}{{ url_for('static', filename='img/favicons/fav_org/favicon-32x32.png') }}",
            "contactPoint": [{
                "@type": "ContactPoint",
                "email": "{{ email }}",
                "telephone": "{{ phone }}",
                "contactType": "customer support",
                "areaServed": "TZ"
            }]
        }
        </script>
    
    <!-- Favicon Links with IDs for dynamic switching -->
    <link id="icon-ico" rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/favicons/fav_org/favicon.ico') }}">
    <link id="icon32" rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='img/favicons/fav_org/favicon-32x32.png') }}">
    <link id="icon16" rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='img/favicons/fav_org/favicon-16x16.png') }}">
    <link id="apple-touch" rel="apple-touch-icon" href="{{ url_for('static', filename='img/favicons/fav_org/apple-touch-icon.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='img/favicons/fav_org/site.webmanifest') }}">
    <meta name="theme-color" content="#0ea5e9">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            dark: '#0f172a',   /* Slate 900 */
                            primary: '#0ea5e9', /* Sky 500 */
                            accent: '#10b981',  /* Emerald 500 */
                            light: '#f8fafc',   /* Slate 50 */
                        }
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script defer src="{{ url_for('static', filename='js/theme.js') }}"></script>
    <script defer src="{{ url_for('static', filename='js/effects.js') }}"></script>
    <script defer src="{{ url_for('static', filename='js/animated-bg.js') }}"></script>
    
    {% include 'includes/analytics.html' ignore missing %}
</head>
<body class="bg-brand-light dark:bg-brand-dark text-slate-700 dark:text-slate-100 font-sans flex flex-col min-h-screen transition-colors duration-300">

    <!-- Animated Scientific Background -->
    {% include 'includes/animated-bg.html' %}

    {% include 'includes/header.html' %}

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="max-w-7xl mx-auto px-4 mt-4">
                {% for category, message in messages %}
                    <div class="p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg border border-green-200" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <main class="flex-grow">
        {% block content %}{% endblock %}
    </main>

    {% include 'includes/news_letter.html' %}

    {% include 'includes/footer.html' %}

    <script>
        // Mobile Menu Toggle Logic
        const btn = document.getElementById('mobile-menu-btn');
        const menu = document.getElementById('mobile-menu');

        if(btn && menu){
            btn.addEventListener('click', () => {
                menu.classList.toggle('hidden');
            });
        }
    </script>
</body>
</html>